{% extends "base.html" %}
{% load staticfiles %}
{% load view_tags %}
{% block title %}TFBS - View TF{% endblock %}
{% block head %}{{ block.super }}
    <link rel="stylesheet" href="{% static "stylesheets/jquery.dataTables.css" %}">
    <style>
      .chart rect {
        stroke: white;
        fill: steelblue;
      }
      .axis path, .axis line {
        fill: none;
        stroke: #000;
        shape-rendering: crispEdges;
      }
    </style>
    <script src="http://d3js.org/d3.v3.min.js" charset="utf-8"></script>
    <script src="{% static "javascripts/jquery.dataTables.min.js" %}"></script>
    <script src="{% static "javascripts/isblogo.js" %}"></script>
    <script src="{% static "javascripts/graphs.js" %}"></script>
    <script type="text/javascript">

    </script>
    <script type="text/javascript">
      var hist = {{histogram_data|hist_to_js}}
      {{motifs|pssms_to_js}}
      {% if motifs %}
      $(document).ready(function() {
        $('#genelist').dataTable();
        nwpgraphs.histogram('#graph_0', hist);
      });
      {% endif %}
    </script>
{% endblock %}
{% block content %}
  {% if tfbs %}
  <h1>{{motif.name}}</h1>
  <div>&nbsp;</div>
  <h2>Motif Sequence Logo</h2></br><div id="canvas_0"></div>
  <div>&nbsp;</div>
  <h2>Motif Positions Relative to TSS (bp)</h2></br><div id="graph_0"></div>
  <div>&nbsp;</div>
  <h2>Target Gene List</h2></br>
  <a href="/tfgenes_csv/{{motif.name}}">Download TF Binding Sites</a>
  <table id="genelist">
    <thead>
    <tr><th>Entrez Id</th><th>Chromosome</th><th>Strand</th><th>Promoter Location</th><th>TSS</th><th># sites</th></tr>
    </thead>
    <tbody>
    {% for t in tfbs_data %}
    <tr>
      <td><a href="/viewgene/{{t.gene__name}}">{{t.0}}</a></td>
      <td>{{t.1}}</td>
      <td>{{t.2}}</td>
      <td>{{t.3}}-{{t.4}}</td>
      <td>{{t.5}}</td>
      <td>{{t.6}}</td>
    </tr>
    {% endfor %}
    </tbody>
  </table>
  <div>&nbsp;</div>
  <a href="/tfgenes_csv/{{motif.name}}">Download TF Binding Sites</a>
  {% else %}
  No TF found for '{{tfname}}'
  {% endif %}
{% endblock %}
