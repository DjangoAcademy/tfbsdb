{% extends "base.html" %}
{% load staticfiles %}
{% load view_tags %}
{% block title %}TFBS - View Gene{% endblock %}
{% block head %}{{ block.super }}
    <link rel="stylesheet" href="{% static "stylesheets/jquery.dataTables.css" %}">

    <script src="{% static "javascripts/jquery.dataTables.min.js" %}"></script>
    <script src="{% static "javascripts/isblogo.js" %}"></script>
    {% if gene %}
    <script type="text/javascript">
      $(document).ready(function() {
        $('#tfbs').dataTable();
      });
    </script>
    {% endif %}
{% endblock %}
{% block content %}
{% if gene %}
  <h1>Gene Entrez {{gene.name}} ({{gene.hgnc}})</h1>
  <div>Description: {{gene.description}}</div>
  <div>Chromosome: {{gene.chromosome}}</div>
  <div>Orientation: {{gene.orientation}}</div>
  <div>Promoter: {{gene.start_promoter}}-{{gene.stop_promoter}}</div>
  <div>TSS: {{gene.tss}}</div>
  <div># motifs: {{gene.motifs.count}}</div>
  <div># TFBS: {{gene.tfbs_set.count}}</div>

  <div>&nbsp;</div>
  <table id="tfbs">
    <thead>
      <tr>
        <th>Motif</th><th>Strand</th><th>Location</th><th>p-value</th>
        <th>Match Sequence</th>
      </tr>
    </thead>
    <tbody>
      {% for tfbs in gene.tfbs_set.all %}
      <tr>
        <td>{{tfbs.motif.name}}<br>({{tfbs.motif.source_database.name}})
        </td>
        <td>{{tfbs.orientation}}</td>
        <td>{{tfbs.start}}-{{tfbs.stop}}</td>
        <td>{{tfbs.p_value}}</td>
        <td>{{tfbs.match_sequence}}</td>
      </tr>
      {% endfor %}
    </tbody>
  </table>
  {% else %}
  No gene found for '{{searchterm}}'
{% endif %}
{% endblock %}
